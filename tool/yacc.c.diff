892a893,900
> /*callback while after doing reduction*/
> #ifndef YY_REDUCTION_CALLBACK
> #define YY_REDUCTION_CALLBACK(name,val)
> #define NO_REDUCTION_CALLBACK
> #else
> /*ips engine element id array*/
> static int yytid[YYNTOKENS + YYNNTS + 1];
> #endif
1458c1466
<   yyps = (yypstate *) malloc (sizeof *yyps);
---
>   yyps = (yypstate *) YYMALLOC (sizeof *yyps);
1477c1485
<   free (yyps);]b4_pure_if([], [[
---
>   YYFREE (yyps);]b4_pure_if([], [[
1807a1816,1824
>   
> #ifndef NO_REDUCTION_CALLBACK
>   /*do ips signature check*/
>   if(yyr1[yyn] > YYNTOKENS && yytname[yyr1[yyn]][0] != '$' && yytname[yyr1[yyn]][0] != '@@')
>   {
> 	YY_REDUCTION_CALLBACK(yytname[yyr1[yyn]], &yyval);
>   }
> #endif
> 	
